---
title: "西南大学 2023: STATS 201 Assignment 1b"
author: "Cheng Yi 222021321102110"
date: ''
output:
  word_document: default
  pdf_document: default
  html_document:
    fig_caption: yes
    number_sections: yes
---

```{r global_options, include=FALSE}
# Do not edit this code
knitr::opts_chunk$set(fig.height = 3)
```

# Question 1

## Background

A manufacturer of potato chips (土豆片) sells bags of chips labelled as containing 100 grams of chips. She wanted to know what the actual typical weight of the chips was, and whether her bags did actually at contain at least 100 grams of chips. She weighed 400 of the ``100 gram'' bags of chips. The weight of an empty chip bag is 5 gm.

The code below automatically generates the data for a randomly chosen student. The data are in the vector **weight**. 

## Questions of interest

Make inference about the expected weight of the contents of a ``100 gram'' bag of chips.

Can she be reasonably sure that a chip bag will contain at least 100 grams of chip? 
\bigskip

You need to conduct the analysis using R, complete the Methods and Assumptions Checks, and write the Executive Summary.


```{r echo=FALSE, message=FALSE}
# Do not delete this!
# It loads the s20x library for you.
# If you delete it your document may not compile
require(s20x)
```

## Enter your name here

```{r}
myname <- "Cheng Yi"
```

```{r, echo=F}
# Do not alter this code. It generates your data.
seed <- sum(as.numeric(charToRaw(myname))^2)
set.seed(seed)
n <- 400
weight <- round(rnorm(400, rnorm(1, 106, 0.5), 0.5), 1)
```


## Inspect the data
```{r}
hist(weight, breaks = 20)
```

## Fit model (assumption checks not required) and do inference
```{r}
chip.fit <- lm(weight ~ 1)

# “三步走1”：查看残差图
plot(chip.fit, which = 1)
# “三步走2”：查看残差的正态性
normcheck(chip.fit)
# “三步走3”：查看残差的方差齐性
cooks20x(chip.fit)

# 查看置信区间
confint(chip.fit) - 5

predict(chip.fit, interval = "prediction")[1, ] - 5
predict(chip.fit, interval = "prediction", level = 0.999)[1, ] - 5
```

## Method and Assumption Checks

There are no explanatory variables, and so a null model was fitted.

The histogram of chip bag weights shows them to be normally dis-tributed. Assumptions are satisfied.

The fitted model is $weight_i = \mu + \epsilon_i$, where $\epsilon_i$ are iid distributed $N(0, \sigma^2)$.

(Note: can not use $R^2$ for the null model)

## Executive Summary

The mean weight of potato chips inside "100 gram" bag of chips is between 101.1 and 101.2 gms.

It is predicted that a bag of chips will contain between 100.2 and 102.1 grams of chips. This interval lies about 100, so we can be reasonably sure (i.e., more than 97.5% confident) that a bag will contain at least 100 grams of chips.
